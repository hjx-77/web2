import{l as e}from"./chunk-CrBtHwfB.js";import{s as a}from"./chunk-CwTCcLJF.js";import{u as l}from"./chunk-CnUS1kyc.js";import{u as s,d as t,g as i}from"./chunk-Bjj3R50d.js";import{_ as n}from"./chunk-D5vRPYkK.js";import{K as o,r as u,am as r,c as m,w as c,V as p,P as v,F as d,ab as h,Z as k,T as f,ai as g,u as b,Q as j,O as y,ad as w,ag as x,W as I}from"./chunk-BEtB-6HN.js";import{_}from"./chunk-CF4e9rG_.js";import{v as N}from"./chunk-CC7_aw_8.js";import"./chunk-lIqasEa_.js";import"./chunk-DHt_odDz.js";import"./chunk-BOsXNQYK.js";import"./chunk-BQCeX3nN.js";import"./chunk-CM4-pTv8.js";import"./chunk-Cnv84qe6.js";import"./chunk-DOSE5gDZ.js";import"./chunk-eUeygJj_.js";import"./chunk-CETJW2Zh.js";import"./chunk-Dljxjl4G.js";import"./chunk-DCzA2D82.js";import"./chunk-q2W0n84r.js";import"./chunk-DezxjiP8.js";import"./chunk-7CVvifAO.js";import"./chunk-DsM932Ci.js";const C={class:"toast toast-top toast-end"},S={key:0,class:"alert alert-error"},U={key:1,class:"alert alert-success"},F={key:2,class:"alert alert-error"},q={class:"flex flex-col items-center gap-6 w-full px-12"},D=["disabled","placeholder"],M=o({__name:"UploadDialog",props:{visible:{type:Boolean,required:!0},visibleModifiers:{}},emits:["update:visible"],setup(a){const{t:i}=l(),n=u("image/*"),o=u(0),I=r(a,"visible"),M=s().globalConfig,T=e.createInstance({name:"imgStore"}),L=u(null),P=m({get:()=>L.value?.fileName||null,set(e){L.value&&e&&(L.value.fileName=e)}}),Q=u();async function R(e){if(!e)return void(L.value=null);/image*/.test(e?.type||"")?L.value=e:o.value=3}function V(){if(L.value){const{data:e,fileName:a}=L.value,l=N();T.setItem(l,{data:e,fileName:a}).then(()=>{o.value=1,async function(){(await T.keys()).length>0&&T.iterate((e,a)=>{M.addImage({id:a,name:e.fileName,url:"Storage"})})}()}).catch(()=>{o.value=2})}}return c(I,e=>{e&&Q.value.showDialog()}),(e,a)=>(v(),p(d,null,[h("div",C,[2===o.value?(v(),p("div",S,[h("span",null,g(b(i)("error.uploadFail")),1)])):f("",!0),1===o.value?(v(),p("div",U,[h("span",null,g(b(i)("error.uploadSuccess")),1)])):f("",!0),3===o.value?(v(),p("div",F,[h("span",null,g(b(i)("error.notImage")),1)])):f("",!0)]),k(t,{ref_key:"uploadDialogRef",ref:Q,visible:I.value,"onUpdate:visible":a[1]||(a[1]=e=>I.value=e),title:b(i)("dialog.uploadImageTitle"),"submit-func":V,class:""},{content:j(()=>[h("div",q,[I.value?(v(),y(_,{key:0,"limit-type":n.value,onUploadFile:R},null,8,["limit-type"])):f("",!0),w(h("input",{"onUpdate:modelValue":a[0]||(a[0]=e=>P.value=e),disabled:null===L.value,type:"text",placeholder:b(i)("placeHolder.imageName"),class:"input w-full"},null,8,D),[[x,P.value]])])]),_:1},8,["visible","title"])],64))}}),T={class:""},L={for:"explore"},P={class:"p-0"},Q={class:"flex items-center gap-8"},R={class:"avatar h-14"},V={class:"w-12 h-12 mask mask-squircle hover:w-14 hover:h-14"},B={class:"w-64"},G={class:"overflow-hidden font-bold whitespace-nowrap text-ellipsis"},H=["onClick"],J=o({__name:"index",setup(t){const{t:o}=l(),r=s().globalConfig,{getImageList:m}=a(r),f=u(0),y=e.createInstance({name:"imgStore"}),w=u(!1);return c(()=>f.value,e=>{0!==e&&setTimeout(()=>{f.value=0},2e3)}),(e,a)=>(v(),p(d,null,[k(M,{visible:w.value,"onUpdate:visible":a[0]||(a[0]=e=>w.value=e)},null,8,["visible"]),h("div",null,[k(n,{title:b(o)("sidebar.imagesManagement")},{buttons:j(()=>[h("div",T,[h("label",L,[h("span",{class:"btn btn-primary btn-sm",onClick:a[1]||(a[1]=e=>w.value=!0)},g(b(o)("button.upload")),1)])])]),_:1},8,["title"]),h("ul",P,[(v(!0),p(d,null,I(b(m),e=>(v(),p("li",{key:e.id,class:"mb-3"},[h("div",Q,[h("div",R,[h("div",V,[k(i,{"img-item":e},null,8,["img-item"])])]),h("div",B,[h("div",G,g(e.name),1)]),h("div",null,[h("button",{class:"btn btn-error btn-xs",onClick:a=>function(e){"Storage"===e.url&&y.removeItem(e.id).then(()=>{r.removeImage(e.id)}),r.removeImage(e.id)}(e)},g(b(o)("button.delete")),9,H)])])]))),128))])])],64))}});export{J as default};
